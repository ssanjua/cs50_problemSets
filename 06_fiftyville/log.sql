-- Keep a log of any SQL queries you execute as you solve the mystery.

-- find the crime scene: 29 july 2021, humprhey street --
select description
from  crime_scene_reports
where year = 2021
and month = 7
and day = 28
and street like '%Humphrey Street%%';

-- identify suspects --
select name, transcript
from interviews
where year = 2021
and month = 7
and day = 28;

-- check ATM logs --
SELECT account_number, year, month, day
FROM atm_transactions
WHERE year = 2021
AND month = 7
AND day = 28
AND atm_location LIKE "%Leggett Street%";

+----------------+------+-------+-----+
| account_number | year | month | day |
+----------------+------+-------+-----+
| 28500762       | 2021 | 7     | 28  |
| 28296815       | 2021 | 7     | 28  |
| 76054385       | 2021 | 7     | 28  |
| 49610011       | 2021 | 7     | 28  |
| 16153065       | 2021 | 7     | 28  |
| 86363979       | 2021 | 7     | 28  |
| 25506511       | 2021 | 7     | 28  |
| 81061156       | 2021 | 7     | 28  |
| 26013199       | 2021 | 7     | 28  |
+----------------+------+-------+-----+

--ATM info--
SELECT people.name, people.phone_number, bank_accounts.account_number, passengers.flight_id, passengers.seat
FROM people
JOIN bank_accounts ON people.id = bank_accounts.person_id
JOIN passengers ON people.passport_number = passengers.passport_number
WHERE bank_accounts.account_number IN (28500762, 28296815, 76054385, 49610011, 16153065, 86363979, 25506511, 81061156, 26013199)
AND passengers.flight_id = 36;

+--------+----------------+----------------+-----------+------+
|  name  |  phone_number  | account_number | flight_id | seat |
+--------+----------------+----------------+-----------+------+
| Bruce  | (367) 555-5533 | 49610011       | 36        | 4A   |
| Kenny  | (826) 555-1652 | 28296815       | 36        | 7A   |
| Luca   | (389) 555-5198 | 28500762       | 36        | 7B   |
| Taylor | (286) 555-6063 | 76054385       | 36        | 6D   |
+--------+----------------+----------------+-----------+------+

-- check floght info -
SELECT flights.id, airports.abbreviation, hour, minute
FROM flights
JOIN airports ON flights.origin_airport_id = airports.id
WHERE year = 2021
AND month = 7
AND day = 29
ORDER BY hour, minute;

+----+--------------+------+--------+
| id | abbreviation | hour | minute |
+----+--------------+------+--------+
| 36 | CSF          | 8    | 20     |
| 43 | CSF          | 9    | 30     |
| 23 | CSF          | 12   | 15     |
| 53 | CSF          | 15   | 20     |
| 18 | CSF          | 16   | 0      |
+----+--------------+------+--------+

--check phone calls --
SELECT caller, receiver, year, month, day, duration
FROM phone_calls
WHERE year = 2021
AND month = 7
AND day = 28
ORDER BY duration;

+----------------+----------------+------+-------+-----+----------+
|     caller     |    receiver    | year | month | day | duration |
+----------------+----------------+------+-------+-----+----------+
| (499) 555-9472 | (892) 555-8872 | 2021 | 7     | 28  | 36       |
| (031) 555-6622 | (910) 555-3251 | 2021 | 7     | 28  | 38       |
| (286) 555-6063 | (676) 555-6554 | 2021 | 7     | 28  | 43       |
| (367) 555-5533 | (375) 555-8161 | 2021 | 7     | 28  | 45       |
| (770) 555-1861 | (725) 555-3243 | 2021 | 7     | 28  | 49       |
| (499) 555-9472 | (717) 555-1342 | 2021 | 7     | 28  | 50       |
| (130) 555-0289 | (996) 555-8899 | 2021 | 7     | 28  | 51       |
| (338) 555-6650 | (704) 555-2131 | 2021 | 7     | 28  | 54       |
| (826) 555-1652 | (066) 555-9701 | 2021 | 7     | 28  | 55       |
| (609) 555-5876 | (389) 555-5198 | 2021 | 7     | 28  | 60       |
| (751) 555-6567 | (594) 555-6254 | 2021 | 7     | 28  | 61       |
| (669) 555-6918 | (971) 555-6468 | 2021 | 7     | 28  | 67       |
| (636) 555-4198 | (670) 555-8598 | 2021 | 7     | 28  | 69       |
| (367) 555-5533 | (704) 555-5790 | 2021 | 7     | 28  | 75       |
| (016) 555-9166 | (336) 555-0077 | 2021 | 7     | 28  | 88       |
| (730) 555-5115 | (343) 555-0167 | 2021 | 7     | 28  | 101      |
| (704) 555-2131 | (891) 555-5672 | 2021 | 7     | 28  | 103      |
| (873) 555-3868 | (047) 555-0577 | 2021 | 7     | 28  | 109      |
| (394) 555-3247 | (035) 555-2997 | 2021 | 7     | 28  | 111      |
| (233) 555-0473 | (831) 555-0973 | 2021 | 7     | 28  | 113      |
| (867) 555-9103 | (068) 555-0183 | 2021 | 7     | 28  | 116      |
| (367) 555-5533 | (344) 555-9601 | 2021 | 7     | 28  | 120      |
| (219) 555-0139 | (910) 555-3251 | 2021 | 7     | 28  | 121      |
| (996) 555-8899 | (059) 555-4698 | 2021 | 7     | 28  | 142      |
| (918) 555-5327 | (060) 555-2489 | 2021 | 7     | 28  | 146      |
| (801) 555-9266 | (984) 555-5921 | 2021 | 7     | 28  | 148      |
| (971) 555-6468 | (267) 555-2761 | 2021 | 7     | 28  | 149      |
| (676) 555-6554 | (328) 555-9658 | 2021 | 7     | 28  | 153      |
| (711) 555-3007 | (113) 555-7544 | 2021 | 7     | 28  | 157      |
| (293) 555-1469 | (749) 555-4874 | 2021 | 7     | 28  | 195      |
| (704) 555-5790 | (772) 555-5770 | 2021 | 7     | 28  | 200      |
| (669) 555-6918 | (914) 555-5994 | 2021 | 7     | 28  | 233      |
| (286) 555-6063 | (310) 555-8568 | 2021 | 7     | 28  | 235      |
| (398) 555-1013 | (329) 555-5870 | 2021 | 7     | 28  | 237      |
| (491) 555-2505 | (478) 555-1565 | 2021 | 7     | 28  | 241      |
| (367) 555-5533 | (022) 555-4052 | 2021 | 7     | 28  | 241      |
| (547) 555-8781 | (398) 555-1013 | 2021 | 7     | 28  | 272      |
| (839) 555-1757 | (487) 555-5865 | 2021 | 7     | 28  | 278      |
| (608) 555-9302 | (725) 555-3243 | 2021 | 7     | 28  | 280      |
| (771) 555-7880 | (711) 555-3007 | 2021 | 7     | 28  | 288      |
| (450) 555-8297 | (771) 555-7880 | 2021 | 7     | 28  | 298      |
| (357) 555-0246 | (502) 555-6712 | 2021 | 7     | 28  | 305      |
| (336) 555-0077 | (098) 555-1164 | 2021 | 7     | 28  | 318      |
| (914) 555-5994 | (973) 555-3809 | 2021 | 7     | 28  | 320      |
| (666) 555-5774 | (125) 555-8030 | 2021 | 7     | 28  | 326      |
| (324) 555-0416 | (452) 555-8550 | 2021 | 7     | 28  | 328      |
| (594) 555-6254 | (123) 555-5144 | 2021 | 7     | 28  | 346      |
| (711) 555-3007 | (147) 555-6818 | 2021 | 7     | 28  | 358      |
| (918) 555-2946 | (006) 555-0505 | 2021 | 7     | 28  | 359      |
| (594) 555-2863 | (491) 555-2505 | 2021 | 7     | 28  | 361      |
| (258) 555-5627 | (695) 555-0348 | 2021 | 7     | 28  | 368      |
| (068) 555-0183 | (770) 555-1861 | 2021 | 7     | 28  | 371      |
| (047) 555-0577 | (059) 555-4698 | 2021 | 7     | 28  | 379      |
| (695) 555-0348 | (338) 555-6650 | 2021 | 7     | 28  | 383      |
| (478) 555-1565 | (031) 555-6622 | 2021 | 7     | 28  | 398      |
| (342) 555-9260 | (219) 555-0139 | 2021 | 7     | 28  | 404      |
| (579) 555-5030 | (971) 555-6468 | 2021 | 7     | 28  | 421      |
| (801) 555-9266 | (608) 555-9302 | 2021 | 7     | 28  | 425      |
| (971) 555-6468 | (258) 555-5627 | 2021 | 7     | 28  | 441      |
| (901) 555-8732 | (491) 555-2505 | 2021 | 7     | 28  | 451      |
| (725) 555-4692 | (821) 555-5262 | 2021 | 7     | 28  | 456      |
| (209) 555-7806 | (693) 555-7986 | 2021 | 7     | 28  | 487      |
| (122) 555-4581 | (831) 555-0973 | 2021 | 7     | 28  | 491      |
| (060) 555-2489 | (204) 555-4136 | 2021 | 7     | 28  | 510      |
| (219) 555-0139 | (867) 555-9103 | 2021 | 7     | 28  | 514      |
| (696) 555-9195 | (258) 555-5627 | 2021 | 7     | 28  | 525      |
| (770) 555-1196 | (324) 555-0416 | 2021 | 7     | 28  | 527      |
| (984) 555-5921 | (618) 555-9856 | 2021 | 7     | 28  | 546      |
| (380) 555-4380 | (680) 555-4935 | 2021 | 7     | 28  | 550      |
| (342) 555-9260 | (487) 555-5865 | 2021 | 7     | 28  | 560      |
| (041) 555-4011 | (609) 555-5876 | 2021 | 7     | 28  | 565      |
| (478) 555-1565 | (717) 555-1342 | 2021 | 7     | 28  | 573      |
| (234) 555-1294 | (772) 555-5770 | 2021 | 7     | 28  | 573      |
| (749) 555-4874 | (492) 555-5484 | 2021 | 7     | 28  | 575      |
| (328) 555-9658 | (775) 555-7584 | 2021 | 7     | 28  | 579      |
| (301) 555-4174 | (711) 555-3007 | 2021 | 7     | 28  | 583      |
| (544) 555-8087 | (389) 555-5198 | 2021 | 7     | 28  | 595      |
+----------------+----------------+------+-------+-----+----------+

SELECT people.name, phone_calls.caller
FROM people
JOIN phone_calls ON people.phone_number = phone_calls.caller
WHERE phone_calls.duration <= 40;

+------------+----------------+
|    name    |     caller     |
+------------+----------------+
| Maria      | (492) 555-5484 |
| Sharon     | (343) 555-0167 |
| Peter      | (751) 555-6567 |
| Sarah      | (505) 555-5698 |
| Dylan      | (380) 555-4380 |
| Scott      | (801) 555-8906 |
| Ernest     | (789) 555-8833 |
| Kelsey     | (499) 555-9472 |
| Carina     | (031) 555-6622 |
| Jacqueline | (910) 555-3251 |
| Ryan       | (901) 555-8732 |
| Bruce      | (367) 555-5533 |
| Juan       | (337) 555-9411 |
| Janice     | (033) 555-9033 |
| Frank      | (356) 555-6641 |
+------------+----------------+

-- BRUCE call ? --

SELECT name
FROM people
WHERE phone_number = '(375) 555-8161';

+-------+
| name  |
+-------+
| Robin |
+-------+

-- destination? --

SELECT airports.city
FROM flights
JOIN airports ON flights.destination_airport_id = airports.id
WHERE flights.id = 36;

+---------------+
|     city      |
+---------------+
| New York City |
+---------------+